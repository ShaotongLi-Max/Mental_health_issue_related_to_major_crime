---
title: "Mental health issue linked to major crime*"
author: Max LI
thanks: "Code and data are available at: https://github.com/ShaotongLi-Max/STA304-Paper-1-MaxLI."
date: 2024/9/21
date-format: long
abstract: "This Paper aims at discussing the relationship between Mental Health issue and committing crime. Using data from opendatatoronto, we can see Mental Health Act Apprehensions and major crime indicators of several police divisions in toronto. There appears to be positive linear relationship between the number of people having MHA apprehensions and number of crimes."
format: 
  pdf:
    toc: true           
    toc-title: "Table of Contents" 
    toc-depth: 2        
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(dplyr)
library(knitr)
library(gt)
library(broom)
```

# 1.Introduction

Mental Health Act is the law that describes what should happen when someone, in mental illness, should be treated to protect themselves and others around. The new Mental Health Act issued in 2014 set new regulations towards teenagers: "MHA Apprehensions of individuals aged 17 and under have been omitted to protect youth identity. From 2014 to 2020, these individuals comprised 6.5% (4,724 of 71,717) of all MHA Apprehensions, with individuals under 12 comprising 0.4% (320 of 71,717), and 12-17 comprising 6.1% (4,404 of 71,717) respectively. There are instances where an individual’s age group is classified as “Not Recorded”; these account for 1.3% (915 of 71,717) of all MHA Apprehensions." (*Mental Health Apprehensions*, 2023)[@mha_toronto] Now all data of MHA Apprehensions is stored in the data set provided by Toronto police department.

According to the research provided by Public Safety Canada, of the 5 million people who came into contact with police, approximately one in five (18.8%) met the criteria for a mental or substance use disorder. One in three Canadians with a mental health disorder reported having contact with police for at least one reason studied (34.4%).(*Annual Report on the State of Homelessness in Canada*,2017)[@PublicSafetyCanada] This is suggesting that there could be a positive relationship between Mental illness and crime rate.

This paper confirm that there is a positive linear relationship between mental health issue and major crime.First, it explores the data of MHA Apprehensions of all ages in several Toronto police divisions. Next, it explores the data of major crime numbers relating to each district. Finally, it develops a linear model of two data and plot the relationship between mental illness and major crime numbers.

# 2.Data

The data used in this paper came from the Open Data Toronto portal through the library opendatatoronto (Gelfand 2022)[@OpenDataToronto]. Data were cleaned and analyzed using the open source statistical programming language R (R Core Team 2023)[@R]. Libraries tidyverse (Wickham et al. 2019)[@tidyverse], dplyr (Wickham et al. 2023)[@dplyr], and lubridate (Grolemund and Wickham 2011)[@lubridate] were used for simulating, cleaning and testing. Graphics were made using ggplot2 (Wickham 2016)[@ggplot2], gt(Graham 2023)[@gt] and broom(Robinson and Wickham 2023)[@broom].

\newpage

# 3.1 Mental Health Act Apprehensions Data

The Mental Health Act Apprehensions Data are provided by Toronto Police Services. It includes all Mental Health Act (MHA) Apprehensions pursuant to the Mental Health Act, assigning different event numbers as distinct MHA Apprehensions. This data set is queried based on reported date and the last refreshed date is July 23,2024.

This data set specifically list the identity of the person who has MHA Apprehensions as well as the corresponding MHA type, which are as follows:

-   Section 15 (Form 1 - Physician - Application for Psychiatric Assessment);
-   Section 16 (Form 2 – Justice of the Peace – Order for Examination);
-   Section 17 (Police Officer’s Power of Apprehension);
-   Section 28 (1) (Form 9 - Elopee - Order for Return); and,
-   Section 33.4 (Form 47 - Community Treatment Order for Examination).

However, there are limitations to this data: A unique event number should not be interpreted as an apprehension of a distinct individual. An individual may have been apprehended multiple times under the Mental Health Act, with each apprehension recorded using a unique event number.(*Mental Health Apprehensions*,2023)[@mha_toronto]

Therefore, the columns chosen for this analysis were simply: "DIVISION" representing the Police Division where Offence Occurred. In cleaning data process, a new column "num_mha_reports" was made in the analysis data, representing the number of MHA reports in each police division.

# 3.2 Results of MHA Apprehensions Data

```{r,fig.pos='H'}
#| label: MHA Apprehensions Data
#| fig-cap: Number of MHA reports in each Police division (2014-2024)
#| echo: false
#| warning: false
#| message: false


data_file_path <- "/home/rstudio/STA304_Paper_1_MaxLI/data/analysis_data/clean_data.csv"
clean_data <- read.csv(data_file_path)

clean_data <- clean_data %>%
  arrange(DIVISION)

clean_data$DIVISION <- factor(clean_data$DIVISION, levels = clean_data$DIVISION)

ggplot(clean_data, aes(y = DIVISION, x = num_mha_reports)) +
  geom_bar(stat = "identity", fill = "#4E79A7", color = "black", width = 0.7) + # Custom color and bar width
  labs(title = "Number of MHA Reports by Division",
       y = "Police Division",
       x = "MHA Reports") +
  theme_minimal(base_size = 14) + # Improved theme with larger base font size
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5), # Centered and bold title
    axis.text.y = element_text(size = 12), # Resized y-axis labels
    axis.title.y = element_text(face = "bold", size = 14),
    axis.title.x = element_text(face = "bold", size = 14)
  ) +
  scale_x_continuous(expand = expansion(mult = c(0, 0.05)), limits = c(0, max(clean_data$num_mha_reports) * 1.1)) + # Dynamic x-axis with padding
  geom_text(aes(label = num_mha_reports), hjust = -0.2, size = 4) # Display the values to the right of the bars

```

\newpage

# 4.1 Major crime indicator

The Major crime indicator data are provided by Toronto Police Services.It includes some major kinds of crime like Assault, Break and Enter, Auto Theft, Robbery and Theft Over that happened in every police division in Toronto. This data set is queried based on reported date and the last refreshed date is July 23,2024.

This data includes all MCI occurrences reported to the Toronto Police Service, including those where the location has not been able to be verified.However, this data does not include occurrences that have been deemed unfounded.(*Major Crime Indicators*,2023)[@mci_toronto]

The columns chosen for this analysis were simply: "DIVISION" representing the Police Division where major crime Occurred. In cleaning data process, a new column "num_crimes" was made in the analysis data, representing the number of major crimes took place in each police division.

# 4.2 Results of Major Crime Indicator Data

```{r,fig.pos='H'}
#| label: Major Crime Indicator Data
#| fig-cap: Number of Major Crime Indicator in each Police division (2014-2024)
#| echo: false
#| warning: false
#| message: false

abbreviate_number <- function(x) {
  ifelse(x >= 1000, paste0(round(x / 1000, 1), "k"), x)
}

ggplot(clean_data, aes(y = DIVISION, x = num_crimes)) +
  geom_bar(stat = "identity", fill = "#E15759", color = "black", width = 0.7) + 
  labs(title = "Number of Crimes by Division",
       y = "Division",
       x = "Crime Incidents") +
  theme_minimal(base_size = 14) + 
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5), 
    axis.text.y = element_text(size = 12), 
    axis.title.y = element_text(face = "bold", size = 14),
    axis.title.x = element_text(face = "bold", size = 14)
  ) +
  scale_x_continuous(expand = expansion(mult = c(0, 0.05)), limits = c(0, max(clean_data$num_crimes) * 1.1), 
                     labels = abbreviate_number) + 
  geom_text(aes(label = abbreviate_number(num_crimes)), 
            hjust = -0.2, size = 4) 

```

\newpage

# 5.MHA reports relationship to Major Crime Indicator

There appears to be a positive relationship between the number of MHA reports and the number of Major Crime Indicator. The higher the number of MHA reports, the more Major Crime Indicator in the same police division.

```{r,fig.pos='H'}
#| label: Linear model
#| fig-cap: Linear Model
#| echo: false
#| warning: false
#| message: false

clean_data <- read.csv("/home/rstudio/STA304_Paper_1_MaxLI/data/analysis_data/clean_data.csv")
model <- lm(num_crimes ~ num_mha_reports, data = clean_data)
par(mfrow = c(2, 2))
clean_data$predicted_crimes <- predict(model, newdata = clean_data)
ggplot(clean_data, aes(x = num_mha_reports, y = num_crimes)) +
  geom_point(color = "blue") +
  geom_line(aes(y = predicted_crimes), color = "red") +
  labs(title = "Number of Crimes vs. Number of MHA Reports",
       x = "Number of MHA Reports",
       y = "Number of Crimes") +
  theme_minimal()
```

Based on the positive relationship between crimes and MHA reports, a linear model is made to fit in this situation:

$$
C = 6748.244 + 2.451 \times MHA
$$ in which:

-   **C**\
    C stands for the predicted number of crimes, which is also the dependent variable in this model.

-   **Intercept:** 6748.244\
    This suggests that, even when there are no MHA reports, the baseline number of crimes in a division is approximately 6748.

-   **MHA:** 2.451\
    For each additional MHA report, the model predicts an increase of approximately 2.45 crimes in the corresponding division.

```{r,fig.pos='H'}
#| label: Linear model summary
#| fig-cap: The summary table for linear model
#| echo: false
#| warning: false
#| message: false

model_summary <- tidy(model)
model_stats <- glance(model)

coefficients_df <- model_summary %>%
  select(term, estimate, p.value)

model_stats_df <- data.frame(term = c("R-squared", "Adjusted R-squared"),
                              estimate = c(model_stats$r.squared, model_stats$adj.r.squared),
                              p.value = c(NA, NA))

final_summary_df <- coefficients_df  # Only keep coefficients_df

summary_table <- gt(data = final_summary_df) %>%
  tab_header(title = "Linear Model Summary") %>%
  text_transform(
    locations = cells_body(columns = vars(term)),
    fn = function(x) ifelse(x == "(Intercept)", "Intercept", x)
  ) %>%
  fmt_number(
    columns = c(estimate, p.value),  # Only format the estimate and p.value
    decimals = 3
  ) %>%
  cols_label(
    estimate = "Estimate",
    p.value = "P-value"
  ) %>%
  cols_align(align = "center", columns = vars(estimate, p.value)) %>%
  tab_footnote(
    footnote = paste("Adjusted R-squared:", round(model_stats$adj.r.squared, 3)),
    locations = cells_title(groups = "title")
  ) %>%
  tab_footnote(
    footnote = paste("R-squared:", round(model_stats$r.squared, 3)),
    locations = cells_title(groups = "title")
  )

summary_table


```

\newpage

# 6.Discussion

This paper investigated the relationship between the number of Mental Health Act Apprehensions and the major crime indicator, according to Toronto Police Services data retrieved from OpenData Toronto. Results shows that as the number of MHA reports rises, the major crime indicator also increases, based on data from 2014 to 2024. Furthermore, there appears to be a positive linear relationship between the number of MHA reports and the number of major crime indicator, which can be expressed as a linear model: C = 6748.244 + 2.451 \* MHA.

The result of this paper fits the result of the research by Public Safety Canada: "In the international research for both youth and adults analyzed for this report, findings suggest that certain mental health disorders, such as substance use disorder, conduct disorder, and antisocial personality disorder were shown to have a significant correlation to offending and re-offending." The p-value of our model is 4.19\*10\^-5, which is far blow the significance level of 0.05, indicating strong correlation between the number of Mental Health Act Apprehensions and the major crime indicator.(*Annual Report on the State of Homelessness in Canada*,2017)[@PublicSafetyCanada]

However, other variables like population could affect the number of both MHA reports and major crime indicator. Population is not included in Major crime indicator data and MHA Apprehensions Data. Adding population as a independent variable to the model could be a way of studying the relationship between MHA reports and major crime indicator.

The finding in this paper help to let people understand the link between mental health issue and crime. As further study or research confirm to the result of this paper, it could help government put more enphasis on enhancing health care for people with mental disorder and saving countless lives.

# 7.Limitation

The linear model indeed shows significant linear relationship between the number of MHA reports and major crime indicator. However, the adjusted R-squared in this model is 0.6388, indicating that there are 36.12% of the variance left unexplained by the model. This could imply that other factors, aside from MHA reports, might be influencing crime rates.

Also, the residual in this model is quite large. This could be due to the fact that there are only 20 police divisions in toronto, which is considered a small sample. From figure 4, the residual line is not a horizontal line, indicating the same problem.

```{r,fig.pos='H'}
#| label: Residual Plot
#| fig-cap: The Residual Vs Fitted value plot
#| echo: false
#| warning: false
#| message: false


plot(model, which = 1)
```

\newpage

# 8.Reference

R Core Team. 2023. R: A Language and Environment for Statistical Computing. Vienna, Austria: R Foundation for Statistical Computing. https://www.R-project.org/.

Gelfand, Jack. 2022. opendatatoronto: Accesses the City of Toronto Open Data Portal. R package version 0.1.0. https://CRAN.R-project.org/package=opendatatoronto.

Wickham, Hadley, Bryan, Jennifer, et al. 2019. Welcome to the Tidyverse. Journal of Open Source Software, 4(43), 1686. https://doi.org/10.21105/joss.01686.

Wickham, Hadley, François, Romain, Henry, Lionel, Müller, Kirill, and Vaughan, Davis. 2023. dplyr: A Grammar of Data Manipulation. R package version 1.1.2. https://CRAN.R-project.org/package=dplyr.

Grolemund, Garrett, and Wickham, Hadley. 2011. Dates and Times Made Easy with {lubridate}. Journal of Statistical Software, 40(3), 1-25. https://www.jstatsoft.org/article/view/v040i03.

Wickham, Hadley. 2016. ggplot2: Elegant Graphics for Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org.

Graham, J. 2023. gt: A Grammar of Tables. https://cran.r-project.org/web/packages/gt/index.html.

Robinson, D., and J. T. H. E. 2023. broom: Convert Statistical Analysis Objects into Tidy Data Frames. https://cran.r-project.org/web/packages/broom/index.html.

City of Toronto. 2022. Open Data Toronto Portal. https://opendata.toronto.ca/.

Public Safety Canada. 2017. 2017 Annual Report on the State of Homelessness in Canada. Government of Canada. https://www.publicsafety.gc.ca/cnt/rsrcs/pblctns/2017-h01-cp/index-en.aspx.

City of Toronto. 2023. Major Crime Indicators - Open Toronto. Toronto, Ontario: City of Toronto. https://open.toronto.ca/dataset/major-crime-indicators/.

City of Toronto. 2023. Mental Health Apprehensions - Open Toronto. Toronto, Ontario: City of Toronto. https://open.toronto.ca/dataset/mental-health-apprehensions/.
